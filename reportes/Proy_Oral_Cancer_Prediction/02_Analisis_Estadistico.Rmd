---
title: "Gu√≠a de Gr√°ficos para el An√°lisis Exploratorio de Datos (EDA)"
author: "Enrique D√≠az Ocampo"
date: "`r Sys.Date()`"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
# üìå Configuraci√≥n inicial
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

## 1Ô∏è‚É£ **Introducci√≥n**
Esta gu√≠a proporciona una serie de gr√°ficos para realizar un **An√°lisis Exploratorio de Datos (EDA)** en diferentes niveles:

- **An√°lisis Unidimensional:** Distribuci√≥n de una sola variable.

- **An√°lisis Multivariado:** Relaci√≥n entre dos o m√°s variables.

- **Visualizaci√≥n con `ggplot2`** para explorar patrones en los datos.

Esta gu√≠a te ayudar√° a seleccionar el gr√°fico m√°s adecuado seg√∫n el tipo de variable analizada.

---

## 2Ô∏è‚É£ **Carga de Librer√≠as y Configuraci√≥n**
```{r}
# üìå Cargar librer√≠as necesarias
library(here)           # Manejo de rutas din√°micas
library(janitor)        # Limpieza de nombres de columnas
library(summarytools)   # Resumen estad√≠stico detallado
library(ggplot2)        # Gr√°ficos
library(dplyr)          # Manipulaci√≥n de datos
library(plotly)         # G≈ïaficos Interactivos

# üìå Configuraci√≥n de gr√°ficos globales
theme_set(theme_minimal())
source(here("reportes/Proy_Oral_Cancer_Prediction/00_CONFIGURACION.r"))

# üìå Cargar scripts de preprocesamiento
source(here("scripts/utils.r"))
source(here("scripts/1_preprocesamiento_esp_dataset.r"))
source(here("scripts/2_analisis_gr√°fico.r"))
```

---

## 3Ô∏è‚É£ **Carga y Preprocesamiento de Datos**
```{r}
# üìå Cargar y preprocesar el dataset
dataset_oral_cancer <- preprocesar_datos(here("datasets/oral_cancer_data_limpio.csv"), "Oral Cancer")
```

üìå **¬øQu√© hace esta funci√≥n?**

‚úî Limpia los nombres de las columnas.

‚úî Convierte variables categ√≥ricas en factores.

‚úî Filtra valores inv√°lidos.

‚úî Retorna un dataset listo para an√°lisis.

---

## 4Ô∏è‚É£ **An√°lisis Unidimensional**
El an√°lisis unidimensional permite estudiar la distribuci√≥n de una sola variable.

### üìå **Boxplot para una variable cuantitativa**

üìå **√ötil para:** Detectar valores at√≠picos y distribuci√≥n de datos.

```{r}
# Crear el boxplot usando la funci√≥n crear_boxplot
p_boxplot_edad <- crear_boxplot(data = dataset_oral_cancer, y = "age", 
                                title = "Distribuci√≥n de la Edad de los Pacientes", 
                                xlab = "Pacientes", ylab = "Edad", 
                                colores = "lightblue", rotar_x = FALSE)

# Guardar la imagen en la carpeta usando here()
guardar_grafico(p_boxplot_edad, here("reportes/Proy_Oral_Cancer_Prediction/resultados_generados/boxplot_edad.png"))

# Convertir a gr√°fico interactivo
p_boxplot_edad_interactivo <- convertir_interactivo(p_boxplot_edad)
p_boxplot_edad_interactivo
```


### üìå **Histograma para una variable cuantitativa**

üìå **√ötil para:** Observar la distribuci√≥n de frecuencia de una variable num√©rica.

```{r}
# Crear el histograma usando la funci√≥n crear_histograma
p_histograma_edad <- crear_histograma(data = dataset_oral_cancer, x = "age", 
                                      title = "Distribuci√≥n de Edad de los Pacientes", 
                                      xlab = "Edad", ylab = "Frecuencia", 
                                      binwidth = 5, colores = "lightblue", densidad = TRUE)

# Guardar la imagen en la carpeta usando here()
guardar_grafico(p_histograma_edad, here("reportes/Proy_Oral_Cancer_Prediction/resultados_generados/histograma_edad.png"))

# Convertir a gr√°fico interactivo
p_histograma_edad_interactivo <- convertir_interactivo(p_histograma_edad)
p_histograma_edad_interactivo
```

### üìå **Histograma para una variable cuantitativa por categorias**


```{r}
# Definir colores personalizados para g√©nero
colores_genero <- c("Male" = "blue", "Female" = "red")

# Crear el histograma usando la funci√≥n crear_histograma
p_histograma_edad_genero <- crear_histograma(data = dataset_oral_cancer, x = "age", fill = "gender", 
                                             title = "Histograma de Edad por G√©nero", 
                                             xlab = "Edad", ylab = "Frecuencia", 
                                             binwidth = 1, colores = colores_genero)

# Guardar la imagen en la carpeta usando here()
guardar_grafico(p_histograma_edad_genero, here("reportes/Proy_Oral_Cancer_Prediction/resultados_generados/histograma_edad_genero.png"))

# Convertir a gr√°fico interactivo
p_histograma_edad_genero_interactivo <- convertir_interactivo(p_histograma_edad_genero)
p_histograma_edad_genero_interactivo
```

### üìå **Barplot para una variable cualitativa**

üìå **√ötil para:** Mostrar la frecuencia de categor√≠as en una variable cualitativa.

```{r}
# Crear el barplot usando la funci√≥n crear_barplot
p_barplot_genero <- crear_barplot(data = dataset_oral_cancer, x = "gender", fill = "gender", 
                                  title = "Distribuci√≥n de G√©nero", 
                                  xlab = "G√©nero", ylab = "Frecuencia", 
                                  colores = c("Male" = "cyan", "Female" = "pink"))

# Guardar la imagen en la carpeta usando here()
guardar_grafico(p_barplot_genero, here("reportes/Proy_Oral_Cancer_Prediction/resultados_generados/barplot_genero.png"))

# Convertir a gr√°fico interactivo
p_barplot_genero_interactivo <- convertir_interactivo(p_barplot_genero)
p_barplot_genero_interactivo

```




```{r}
# Crear el barplot cruzado usando la funci√≥n crear_barplot
p_barplot_tabaco_genero <- crear_barplot(data = dataset_oral_cancer, x = "gender", fill = "tobacco_use", 
                                         title = "Consumo de Tabaco por G√©nero", 
                                         xlab = "G√©nero", ylab = "Frecuencia", 
                                         colores = c("Yes" = "cyan", "No" = "green"), dodge = TRUE)

# Guardar la imagen en la carpeta usando here()
guardar_grafico(p_barplot_tabaco_genero, here("reportes/Proy_Oral_Cancer_Prediction/resultados_generados/barplot_tabaco_genero.png"))

# Convertir a gr√°fico interactivo
p_barplot_tabaco_genero_interactivo <- convertir_interactivo(p_barplot_tabaco_genero)
p_barplot_tabaco_genero_interactivo
```

### üìå Gr√°fico Interactivo de Distribuci√≥n por Pa√≠s (Country)

```{r}
# Crear gr√°fico de barras para Country usando la funci√≥n crear_barplot
p_country <- crear_barplot(data = dataset_oral_cancer, x = "country", fill = "country", 
                           title = "Distribuci√≥n de Pacientes por Pa√≠s", 
                           xlab = "Pa√≠s", ylab = "Frecuencia", 
                           colores = NULL, voltear = TRUE, legend_position = "none")


# Guardar la imagen usando la funci√≥n guardar_grafico
guardar_grafico(p_country, here("reportes/Proy_Oral_Cancer_Prediction/resultados_generados/barplot_country.png"), ancho = 8, alto = 6)

# Convertir a gr√°fico interactivo usando la funci√≥n convertir_interactivo
p_country_interactivo <- convertir_interactivo(p_country)
p_country_interactivo

```

---

## 5Ô∏è‚É£ **An√°lisis Multivariado**
El an√°lisis multivariado permite explorar relaciones entre dos o m√°s variables.

### üìå **Cualitativa vs Cualitativa** (Gr√°fico de barras cruzado)

üìå **√ötil para:** Comparar la frecuencia de categor√≠as en dos variables cualitativas.
```{r}
# Crear el barplot cruzado usando la funci√≥n crear_barplot
p_barplot_tabaco_pais <- crear_barplot(data = dataset_oral_cancer, x = "country", fill = "tobacco_use", 
                                         title = "Consumo de Tabaco por Pa√≠s", 
                                         xlab = "G√©nero", ylab = "Frecuencia", 
                                         colores = c("Yes" = "cyan", "No" = "green"), dodge = TRUE)

# Rotar las etiquetas del eje X
p_barplot_tabaco_pais <- p_barplot_tabaco_pais +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotar 45 grados y ajustar alineaci√≥n

# Guardar la imagen en la carpeta usando here()
guardar_grafico(p_barplot_tabaco_genero, here("reportes/Proy_Oral_Cancer_Prediction/resultados_generados/barplot_tabaco_pais.png"))

# Convertir a gr√°fico interactivo
p_barplot_tabaco_pais_interactivo <- convertir_interactivo(p_barplot_tabaco_pais)
p_barplot_tabaco_pais_interactivo
```


### üìå **Cuantitativa vs Cualitativa** (Boxplot)
```{r}
# Definir colores personalizados para etapa de c√°ncer
etapa_cancer <- c("0" = "darkorange", "1" = "dodgerblue", "2" = "cyan", "3" = "blue", "4" = "black")

# Crear el boxplot usando la funci√≥n crear_boxplot
p_boxplot_tumor_etapa <- crear_boxplot(data = dataset_oral_cancer, x = "cancer_stage", y = "tumor_size_cm", fill = "cancer_stage", 
                                       title = "Distribuci√≥n del Tama√±o del Tumor por Etapa del C√°ncer", 
                                       xlab = "Etapa del C√°ncer", ylab = "Tama√±o del Tumor (cm)", 
                                       colores = etapa_cancer)

# Guardar la imagen en la carpeta usando here()
guardar_grafico(p_boxplot_tumor_etapa, here("reportes/Proy_Oral_Cancer_Prediction/resultados_generados/boxplot_tumor_etapa.png"))

# Convertir a gr√°fico interactivo
p_boxplot_tumor_etapa_interactivo <- convertir_interactivo(p_boxplot_tumor_etapa)
p_boxplot_tumor_etapa_interactivo

```
üìå **√ötil para:** Comparar la distribuci√≥n de una variable num√©rica en funci√≥n de una variable categ√≥rica.

### üìå **Cuantitativa vs Cuantitativa** (Diagrama de dispersi√≥n)
```{r}
# Crear el scatterplot usando la funci√≥n crear_scatterplot
p_scatter_edad_tumor <- crear_scatterplot(data = dataset_oral_cancer, x = "age", y = "tumor_size_cm", 
                                          title = "Relaci√≥n entre Edad y Tama√±o del Tumor", 
                                          xlab = "Edad", ylab = "Tama√±o del Tumor (cm)", 
                                          colores = "steelblue")

# Guardar la imagen en la carpeta usando here()
guardar_grafico(p_scatter_edad_tumor, here("reportes/Proy_Oral_Cancer_Prediction/resultados_generados/scatter_edad_tumor.png"))

# Convertir a gr√°fico interactivo
p_scatter_edad_tumor_interactivo <- convertir_interactivo(p_scatter_edad_tumor)
p_scatter_edad_tumor_interactivo

```
üìå **√ötil para:** Identificar tendencias y relaciones entre dos variables num√©ricas.

---

## **üìå Conclusi√≥n**
Esta gu√≠a ha mostrado c√≥mo aplicar distintos tipos de gr√°ficos seg√∫n el tipo de an√°lisis deseado:

‚úÖ **An√°lisis Unidimensional:** Estudio de una sola variable.
‚úÖ **An√°lisis Multivariado:** Exploraci√≥n de relaciones entre variables.
‚úÖ **Visualizaci√≥n con `ggplot2`** para obtener insights del dataset.

