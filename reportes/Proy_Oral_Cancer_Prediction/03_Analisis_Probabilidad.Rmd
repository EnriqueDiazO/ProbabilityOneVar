---
title: "C√°lculo de Probabilidades en Oral Cancer Dataset"
author: "Enrique D√≠az Ocampo"
date: "`r Sys.Date()`"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

1Ô∏è‚É£ Introducci√≥n

Este an√°lisis tiene como objetivo calcular probabilidades condicionales en el dataset Oral Cancer Prediction, respondiendo preguntas como:

‚úî ¬øCu√°l es la probabilidad de tener un diagn√≥stico positivo de c√°ncer si el paciente fuma?
‚úî ¬øC√≥mo influye el consumo de alcohol en el diagn√≥stico?

Estos c√°lculos son clave para evaluar factores de riesgo y mejorar la toma de decisiones en salud.

2Ô∏è‚É£ Carga de Librer√≠as y Configuraci√≥n

```{r}
# üìå Cargar librer√≠as necesarias
library(here)           # Rutas din√°micas
library(dplyr)          # Manipulaci√≥n de datos
library(ggplot2)        # Visualizaci√≥n
library(readr)          # Lectura de archivos CSV
library(plotly)         # Gr√°ficos interactivos

# üìå Cargar dataset limpio
dataset_oral_cancer <- read_csv(
  here("datasets/oral_cancer_data_limpio.csv"),
  show_col_types = FALSE
)

```


3Ô∏è‚É£ C√°lculo de Probabilidades Condicionales

Analizamos la relaci√≥n entre factores de riesgo y diagn√≥stico temprano de c√°ncer.


## üìå Probabilidad de Diagn√≥stico Positivo dado que el Paciente Fuma
```{r}

sub_tobacco <- dataset_oral_cancer %>%
  filter(`Tobacco Use` == "Yes")

n_tobacco_total <- nrow(sub_tobacco)
n_tobacco_malignant <- sub_tobacco %>%
  filter(`Early Diagnosis` == "Yes") %>%
  nrow()

p_malignant_given_tobacco <- n_tobacco_malignant / n_tobacco_total
p_malignant_given_tobacco

```


## üìå Probabilidad de Diagn√≥stico Positivo dado que el Paciente Consume Alcohol
```{r}
sub_alcohol <- dataset_oral_cancer %>%
  filter(`Alcohol Consumption` == "Yes")

n_alcohol_total <- nrow(sub_alcohol)
n_alcohol_malignant <- sub_alcohol %>%
  filter(`Early Diagnosis` == "Yes") %>%
  nrow()

p_malignant_given_alcohol <- n_alcohol_malignant / n_alcohol_total
p_malignant_given_alcohol

```



4Ô∏è‚É£ Visualizaci√≥n de Resultados

Generamos gr√°ficos interactivos para una mejor interpretaci√≥n de los datos.

```{r}
p_tobacco <- ggplot(dataset_oral_cancer, aes(x = `Tobacco Use`, fill = `Early Diagnosis`)) +
  geom_bar(position = "fill") +
  labs(title = "Probabilidad de Diagn√≥stico Temprano seg√∫n Uso de Tabaco", 
       x = "Uso de Tabaco", y = "Proporci√≥n", fill = "Diagn√≥stico") +
  theme_minimal(base_size = 14)

# Guardar gr√°fico
ggsave(here("reportes/Proy_Oral_Cancer_Prediction/resultados_generados/probabilidad_tobacco.png"),
       plot = p_tobacco, width = 8, height = 6, bg = "white")

# Convertir en gr√°fico interactivo
ggplotly(p_tobacco)

```



```{r}
p_alcohol <- ggplot(dataset_oral_cancer, aes(x = `Alcohol Consumption`, fill = `Early Diagnosis`)) +
  geom_bar(position = "fill") +
  labs(title = "Probabilidad de Diagn√≥stico Temprano seg√∫n Consumo de Alcohol", 
       x = "Consumo de Alcohol", y = "Proporci√≥n", fill = "Diagn√≥stico") +
  theme_minimal(base_size = 14)

# Guardar gr√°fico
ggsave(here("reportes/Proy_Oral_Cancer_Prediction/resultados_generados/probabilidad_alcohol.png"),
       plot = p_alcohol, width = 8, height = 6, bg = "white")

# Convertir en gr√°fico interactivo
ggplotly(p_alcohol)

```